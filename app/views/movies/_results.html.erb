<turbo-frame id="movies">
  <div class="row g-4">
    <% movies.each do |movie| %>
      <div class="col-md-6 col-lg-4">
        <div class="movie-card">
          <div class="movie-card-image">
            <% if movie.video_file.attached? %>
              <%= image_tag movie.video_file.preview(resize_to_limit: [320, 200]), 
                  alt: "#{movie.title} preview", 
                  loading: "lazy" %>
            <% else %>
              <div class="movie-placeholder">
                <i class="fas fa-film me-2"></i>
                No video available
              </div>
            <% end %>
          </div>
          
          <div class="movie-card-body">
            <h5 class="movie-card-title"><%= movie.title %></h5>
            <p class="movie-card-date">
              <% if movie.release_date %>
                <i class="fas fa-calendar-alt me-1"></i>
                <%= movie.release_date.strftime('%B %d, %Y') %>
              <% end %>
            </p>
            
            <% if movie.is_pro %>
              <span class="movie-card-badge pro">
                <i class="fas fa-crown me-1"></i>Pro
              </span>
            <% else %>
              <span class="movie-card-badge free">
                <i class="fas fa-unlock me-1"></i>Free
              </span>
            <% end %>
            
            <p class="movie-card-description">
              <%= truncate(movie.description, length: 100) %>
            </p>
            
            <% if movie.tags.any? %>
              <div class="movie-card-tags">
                <% movie.tags.limit(3).each do |tag| %>
                  <span class="movie-card-tag"><%= tag.name %></span>
                <% end %>
              </div>
            <% end %>
            
            <%= link_to movie_path(movie), 
                class: 'movie-card-btn', 
                data: { turbo: false } do %>
              <i class="fas fa-play me-2"></i>Watch Now
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  
  <div class="pagination-container">
    <%= paginate movies %>
  </div>
</turbo-frame>
